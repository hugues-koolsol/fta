<!DOCTYPE html>
<html lang="fr">
<head>
 <meta charset="utf-8" />
 <title>html home</title>
 <meta name="viewport" content="width=device-width, initial-scale=1" />
 <!-- meta http-equiv="Refresh" content="0; url='index.php'" / -->
 <link rel="stylesheet" href="index.css" />

</head>
<body>
<div style="height:24px;"></div>
<nav style="background: aliceblue;border: 1px red outset;position: fixed;top: 0;left: 0;width: 100%;">
    <a href="index.html">html home</a>
    <a href="index.php">php home</a>
    <a href="todo.html">todo</a>
    <a href="traiteJs4.html">traiteJs4</a>
    <a href="traitePhp0.html">traitePhp0</a>
    <a href="aa_login.php">login</a>
  </nav>

  <h1>HTML HOME  üåûaa</h1>
  
  
  <ul class="menu2">
    <li><a href="javascript:chargerSourceDeTest()">source de test</a></li>
  </ul>
  <textarea class="txtar1" id="txtar1" rows="10"></textarea>
  <a href="javascript:transformLeRev()">transform</a>
  <div id="message1"></div>
  <div id="resultat1"></div>
  <script type="text/javascript" src="js/core6.js"></script>

<script type="text/javascript">

var startMicro=performance.now();
var endMicro=performance.now();  console.log('temps=',parseInt(((endMicro-startMicro)*1000),10)/1000+' ms');

/*
var chaine = '  antislash \\ quot \' antislash*3+quot \\\' ';
var t=chaine.replace(/[^\\]'/g,"\\'");
alert('{'+chaine +'}\n{'+ t+'}');
*/
/*
var aa='"\'';
alert('<'+aa+'>')
var bb=aa.replace(/"/,'\\"')
var c='';
var me='c="<'+bb+'>"';
eval(me);
alert(c);
*/
//var aaa="\\'\"\\[]";
//var bbb=aaa.replace(/\\/g,"&#92;").replace(/'/g,'&apos;').replace(/"/g,"&quot;").replace(/\[/g,"crochetOuvrant");
//alert(bbb);
//=====================================================================================================================
function chargerSourceDeTest(){
 var t=`#( d√©but aaaa  debut),
a(
  #(test , üëç),
  b(
    xx(
      y(
        #(dedans
          commentaire bloc
        ),
        t,
        v),
      #(aa),
      xx(
        #(dedans
          commentaire bloc
        )),
      #( bb),
      5,
      #(cc
      )
    ),
    #(comment 1),
    y(
      ' dd&nbsp;',
      #( bla
blu),
      ee,
      2,
      #( @ )
    ),
    #( comment 2 ),
    a(b())
  ),
  #(I√±t√´rn√¢ti√¥n√†√†ÃÄliz√¶ti√∏n ‚òÉ üí© ‚ù§ üòÅ üëç),
  ‚Äãf(‚Äãg‚Äã)‚Äã,
  #(üëçüòÅüí•üí™üëé‚òÄüåûüü•üü©"√†aÃÄ")
)
a( p(/ " \\' \\" \\n \\r \\\\r \\\\n \\\\\\\\ /g) , p(" \\\\ \\" \\\\\\" \\n \\r '") , p(' \\\\ \\' \\n \\r "  ') ),
#(
p('\\\\\\' \\' \\r \\n ')


        a( p(/ " \\' \\" \\n \\r \\\\r \\\\n \\\\\\\\ /g) , p(" \\\\ \\" \\n \\r '") , p(' \\\\ \\n \\r "  ') ),

appelf(nomf(f),p(/\\\\\\\\n/g),p('\\\\n'),p('\\\\r'))
      affecte(sql , "\\r\\n \\" \\\\\\\\
      select * from toto
      "),

      affecte(sql , '\\n \\r \\\\r \\\\n 
      select * from toto
      '),

\
)



`;
/*

a( p(/ " \' \" \n \r \\r \\n \\\\ /g) , p(" \\ \" \\\" \n \r '") , p(' \\ \' \n \r "  ') ),
#(
p('\\\' \' \r \n ')


        a( p(/ " \' \" \n \r \\r \\n \\\\ /g) , p(" \\ \" \n \r '") , p(' \\ \n \r "  ') ),

appelf(nomf(f),p(/\\\\n/g),p('\\n'),p('\\r'))
      affecte(sql , "\r\n \" \\\\
      select * from toto
      "),

      affecte(sql , '\n \r \\r \\n 
      select * from toto
      '),


)

*/

 dogid('txtar1').value=t;
}
//=====================================================================================================================
function chargerLeDernierSourceRev(){
 var fta_indexhtml_dernier_fichier_charge=localStorage.getItem("fta_indexhtml_dernier_fichier_charge");
// console.log('fta_indexhtml_dernier_fichier_charge=' , fta_indexhtml_dernier_fichier_charge );
 if(fta_indexhtml_dernier_fichier_charge!==null){
  dogid('txtar1').value=fta_indexhtml_dernier_fichier_charge;
 }
}
//=====================================================================================================================


function transformLeRev(){
  //"√†aÃÄ"
  clearMessages();
  console.log('\n=========================\nd√©but de transforme')
  document.getElementById('message1').innerHTML='';
  document.getElementById('resultat1').innerHTML='';

  var a=document.getElementById('txtar1');
  localStorage.setItem("fta_indexhtml_dernier_fichier_charge", a.value);
  
  
  
  var lines = a.value.split(/\r|\r\n|\n/);
  var count = lines.length;
  a.setAttribute('rows',count+1);
  
  
  
  var startMicro=performance.now();
  var tableau1=iterateCharacters2(a.value);
  var endMicro=performance.now();  
  console.log('mise en tableau endMicro=',parseInt(((endMicro-startMicro)*1000),10)/1000+' ms');
//  console.log(a.value.substr(4,1),a.value.length)
  
  var startMicro=performance.now();
  var matriceFonction1=functionToArray2(tableau1.out,true,false);
  var endMicro=performance.now();  
  console.log('analyse syntaxique endMicro=',parseInt(((endMicro-startMicro)*1000),10)/1000+' ms');

  console.log(matriceFonction1);
//  console.log(JSON.stringify(matriceFonction1.value));
  

  document.getElementById('message1').innerHTML='';
  document.getElementById('resultat1').innerHTML='';


  if(matriceFonction1.status===true){
  
  
    var parent=document.getElementById('resultat1');
    

    var startMicro=performance.now();
    var fonctionReecriteAvecRetour1=arrayToFunct1(matriceFonction1.value,true,false);
    var diResultatsCompactes=document.createElement('pre');
    
    if(fonctionReecriteAvecRetour1.status===true){
    
     var compacteOriginal=arrayToFunct1(matriceFonction1.value,false,false);
     
     
     var tableau2=iterateCharacters2(fonctionReecriteAvecRetour1.value);
     var matriceDeLaFonctionReecrite=functionToArray2(tableau2.out,true,false);
     var compacteReecrit=arrayToFunct1(matriceDeLaFonctionReecrite.value,false,false);
     
     if(compacteOriginal.status==true && compacteReecrit.status===true){
      if(compacteOriginal.value == compacteReecrit.value){
       diResultatsCompactes.innerHTML=diResultatsCompactes.innerHTML+'<hr /><b style="color:green;">üëç sources compact√©s Egaux</b><textarea rows="1" cols="30">'+strToHtml(compacteOriginal.value)+'</textarea>';
      }else{
       diResultatsCompactes.innerHTML=diResultatsCompactes.innerHTML+'<hr /><b style="color:red;">üí•sources compact√©s diff√©rents</b>';
       diResultatsCompactes.innerHTML=diResultatsCompactes.innerHTML+'<br />o='+compacteOriginal.value;
       diResultatsCompactes.innerHTML=diResultatsCompactes.innerHTML+'<br />r='+compacteReecrit.value;
      }
     
     }else{
      diResultatsCompactes.innerHTML=diResultatsCompactes.innerHTML+'<hr /><b style="color:red;">compacteOriginal='+JSON.stringify(compacteOriginal)+'</b>';
      diResultatsCompactes.innerHTML=diResultatsCompactes.innerHTML+'<br /><b style="color:red;">compacteReecrit='+JSON.stringify(compacteReecrit)+'</b>';
     }
     
    }
    var endMicro=performance.now();  
    console.log('tests compactes=',parseInt(((endMicro-startMicro)*1000),10)/1000+' ms');
    
    document.getElementById('resultat1').appendChild(diResultatsCompactes);
    
    
    
    var fonctionReecriteAvecEtColoration1=arrayToFunct1(matriceFonction1.value,true,true);
    var difonctionReecriteAvecRetour1=document.createElement('pre');
    difonctionReecriteAvecRetour1.style.fontSize='0.8em';
    if(fonctionReecriteAvecEtColoration1.status===true){
     difonctionReecriteAvecRetour1.innerHTML='<hr  />arrayToFunctNoComment2:<hr />'+fonctionReecriteAvecEtColoration1.value;
    }else{
     difonctionReecriteAvecRetour1.innerHTML='<hr />üí•arrayToFunctNoComment2:'+fonctionReecriteAvecRetour1.message;
    }
    document.getElementById('resultat1').appendChild(difonctionReecriteAvecRetour1);
    
    
    var t1=document.createElement('table');
    ConstruitHtmlMatrice(t1,matriceFonction1);
    document.getElementById('resultat1').appendChild(t1);
    
    var t2=document.createElement('table');
    
    ConstruitHtmlTableauCaracteres(t2,a.value,tableau1)
    document.getElementById('resultat1').appendChild(t2);
    
    
    
  
  }else{
    var t2=document.createElement('table');
    ConstruitHtmlTableauCaracteres( t2 , a.value , tableau1 );
    document.getElementById('resultat1').appendChild(t2);
  }
  displayMessages('message1');

  
 
}

chargerLeDernierSourceRev();
//transform();
</script>
  
</body></html>