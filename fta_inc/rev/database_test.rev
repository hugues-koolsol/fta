src_php(
/*


SET FOREIGN_KEY_CHECKS=1;
COMMIT;

*/

  ( file_name , database_test ),
  ( file_extension , php ),
  ( file_path , . ),
  source(
    php(
      affecte(
        $src_create_database,
        sql(

          // ==========================
          // SET FOREIGN_KEY_CHECKS=0;
          // SET AUTOCOMMIT = 0;
          // START TRANSACTION;

          set( FOREIGN_KEY_CHECKS , 0 ),
          set( AUTOCOMMIT , 0 ),
          transaction(

            // ==========================================================            
            // SET time_zone = "+00:00";
            // CREATE DATABASE IF NOT EXISTS `fta` DEFAULT CHARACTER SET utf8 
            //       COLLATE utf8_general_ci;
            // USE fta;

            set( time_zone , '+00:00' ),
            create_database(
              ifnotexists(),
              n(fta),
              charset(utf8mb4),
              collate(utf8mb4_general_ci)
            ),
            use(fta),
            drop_table(
              ifexists(),
              n(tbl_user)
            ),

            // ==========================================
            // tables
            create_table(
              ifnotexists(),
              n(tbl_user),
              fields(
                field(
                  n(fld_id_user),
                  type(BIGINT),
                  unsigned(),
                  notnull()
                ),
                field(
                  n(fld_name_user),
                  type( VARCHAR , 64 ),
                  notnull(),
                  default('admin')
                ),
                field(
                  n(fld_password_user),
                  type( VARCHAR , 256 ),
                  notnull(),
                  default('admin')
                )
              )
            ),
            // ===================================================================
            // ALTER TABLE `fta`.`tbl_user` ADD PRIMARY KEY (`fld_id_user`);
            add_primary_key(
              n(tbl_user),
              fields(fld_id_user)
            ),
            // ===================================================================
            // ALTER TABLE `tbl_user` CHANGE `fld_id_user` `fld_id_user` 
            // BIGINT(20) UNSIGNED NOT NULL AUTO_INCREMENT;
            change_field(
              n(tbl_user),
              old_name(fld_id_user),
              new_def(
                field(
                  n(fld_id_user),
                  type( bigint , 20 ),
                  unsigned(),
                  notnull(),
                  auto_increment()
                )
              )
            ),
            // ===================================================================
            // ALTER TABLE `fta`.`tbl_user` ADD UNIQUE `idx_name` (`fld_name_user`);
            add_index(
              n(tbl_user),
              unique(),
              index_name(idx_name),
              fields(fld_name_user)
            ),
            set( FOREIGN_KEY_CHECKS , 1 )
          )
        )
      ),

      // connexion
      // $link = mysqli_connect($v1['server'],$v1['user'],$v1['password'],$v1['dbname']);

      affecte( $serveur , 'localhost:3308' ),
      affecte( $utilisateur , 'admin' ),
      affecte( $mdp , 'admin' ),
      appelf(
        r($link),
        n(mysqli_connect),
        p($serveur),
        p($utilisateur),
        p($mdp)
      ),
      choix(
        si(
          condition( non($link) ),
          alors(
            appelf( n(die) , p( appelf( n(concat) , p(__LINE__) , p(__FILE__) ) ) )
          )
        )
      ),
      appelf(
        n(mysqli_set_charset),
        p($link),
        p('utf8mb4')
      ),
      appelf(
        r($retourSql),
        n(mysqli_multi_query),
        p($link),
        p($src_create_database)
      )
    )
  )
)
/*
DROP TABLE IF EXISTS `bce_tbl__css`;
CREATE TABLE IF NOT EXISTS `bce_tbl__css` (
  `fld_id_css` bigint(20) UNSIGNED NOT NULL AUTO_INCREMENT,
) ENGINE=InnoDB AUTO_INCREMENT=8 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;

INSERT INTO `bce_tbl__css` (`fld_id_css`, `fld_name_css`, `fld_active_css`, 
`fld_json_css`, `fld_tsupd_css`, `fld_tscrt_css`, `fld_cntupd_css`) VALUES
(1, 'production', 1, 'gros json', 
'2019-08-11 12:28:06', '2019-03-13 15:26:56', 67);

*/